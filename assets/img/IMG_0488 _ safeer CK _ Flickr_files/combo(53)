YUI.add("hermes-template-head-meta",(function(e,n){var a=e.Template.Handlebars.revive({1:function(e,n,a,t,l){return'name="'},3:function(e,n,a,t,l){return'property="'},5:function(e,n,a,t,l){return'description="'+e.escapeExpression(e.lambda(n,n))+'"'},compiler:[8,">= 4.3.0"],main:function(e,n,a,t,l){var r,o,i,m=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,c="function",u=e.escapeExpression,p=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]},d="<meta "+(null!=(r=p(a,"if").call(m,null!=n?p(n,"isName"):n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.program(3,l,0),data:l,loc:{start:{line:1,column:6},end:{line:1,column:51}}}))?r:"")+u(typeof(o=null!=(o=p(a,"metaName")||(null!=n?p(n,"metaName"):n))?o:s)===c?o.call(m,{name:"metaName",hash:{},data:l,loc:{start:{line:1,column:51},end:{line:1,column:63}}}):o)+'" content="'+u((p(a,"renderMetaInfo")||n&&p(n,"renderMetaInfo")||s).call(m,null!=n?p(n,"metaValue"):n,{name:"renderMetaInfo",hash:{},data:l,loc:{start:{line:1,column:74},end:{line:1,column:102}}}))+'" ';return o=null!=(o=p(a,"metaDescription")||(null!=n?p(n,"metaDescription"):n))?o:s,i={name:"metaDescription",hash:{},fn:e.program(5,l,0),inverse:e.noop,data:l,loc:{start:{line:1,column:104},end:{line:1,column:163}}},r=typeof o===c?o.call(m,i):o,p(a,"metaDescription")||(r=e.hooks.blockHelperMissing.call(n,r,i)),null!=r&&(d+=r),d+' data-dynamic="true">\n'},useData:!0}),t={};e.Array.each([],(function(n){var a=e.Template.get("hermes/"+n);a&&(t[n]=a)})),e.Template.register("hermes/head-meta",(function(n,l){return(l=l||{}).partials=l.partials?e.merge(t,l.partials):t,a(n,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-head-article",(function(n,t){var l=n.Template.Handlebars.revive({1:function(n,t,l,e,o){var r,a,i=null!=t?t:n.nullContext||{},u=n.hooks.helperMissing,c="function",p=n.escapeExpression,s=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return' <script type="application/ld+json">\n\t{\n\t\t"@context": "https://schema.org",\n\t\t"@type": "BlogPosting",\n\t\t"mainEntityOfPage": {\n\t\t\t"@type": "WebPage",\n\t\t\t"@id": "'+p(typeof(a=null!=(a=s(l,"url")||(null!=t?s(t,"url"):t))?a:u)===c?a.call(i,{name:"url",hash:{},data:o,loc:{start:{line:8,column:11},end:{line:8,column:18}}}):a)+'"\n\t\t},\n\t\t"headline": "'+p(typeof(a=null!=(a=s(l,"title")||(null!=t?s(t,"title"):t))?a:u)===c?a.call(i,{name:"title",hash:{},data:o,loc:{start:{line:10,column:15},end:{line:10,column:24}}}):a)+'",\n'+(null!=(r=s(l,"if").call(i,null!=t?s(t,"photoUrl"):t,{name:"if",hash:{},fn:n.program(2,o,0),inverse:n.noop,data:o,loc:{start:{line:11,column:2},end:{line:18,column:9}}}))?r:"")+(null!=(r=s(l,"if").call(i,null!=t?s(t,"ownerUrl"):t,{name:"if",hash:{},fn:n.program(7,o,0),inverse:n.noop,data:o,loc:{start:{line:19,column:2},end:{line:25,column:9}}}))?r:"")+'\t\t"publisher": {\n\t\t\t"@type": "Organization",\n\t\t\t"name": "Flickr",\n\t\t\t"logo": {\n\t\t\t\t"@type": "ImageObject",\n\t\t\t\t"url": "https://www.flickr.com/images/opensearch-flickr-logo.png",\n\t\t\t\t"width": 64,\n\t\t\t\t"height": 64\n\t\t\t}\n\t\t}'+(null!=(r=s(l,"if").call(i,null!=t?s(t,"description"):t,{name:"if",hash:{},fn:n.program(9,o,0),inverse:n.noop,data:o,loc:{start:{line:35,column:3},end:{line:36,column:41}}}))?r:"")+"\n\t}\n\t<\/script>\n"},2:function(n,t,l,e,o){var r,a,i=null!=t?t:n.nullContext||{},u=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t"image": {\n\t\t\t"@type": "ImageObject",\n\t\t\t"url": "'+n.escapeExpression("function"==typeof(a=null!=(a=u(l,"photoUrl")||(null!=t?u(t,"photoUrl"):t))?a:n.hooks.helperMissing)?a.call(i,{name:"photoUrl",hash:{},data:o,loc:{start:{line:14,column:11},end:{line:14,column:23}}}):a)+'"'+(null!=(r=u(l,"if").call(i,null!=t?u(t,"photoHeight"):t,{name:"if",hash:{},fn:n.program(3,o,0),inverse:n.noop,data:o,loc:{start:{line:14,column:24},end:{line:15,column:35}}}))?r:"")+(null!=(r=u(l,"if").call(i,null!=t?u(t,"photoWidth"):t,{name:"if",hash:{},fn:n.program(5,o,0),inverse:n.noop,data:o,loc:{start:{line:15,column:35},end:{line:16,column:33}}}))?r:"")+"\n\t\t},\n"},3:function(n,t,l,e,o){var r,a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return',\n\t\t\t"height": '+n.escapeExpression("function"==typeof(r=null!=(r=a(l,"photoHeight")||(null!=t?a(t,"photoHeight"):t))?r:n.hooks.helperMissing)?r.call(null!=t?t:n.nullContext||{},{name:"photoHeight",hash:{},data:o,loc:{start:{line:15,column:13},end:{line:15,column:28}}}):r)},5:function(n,t,l,e,o){var r,a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return',\n\t\t\t"width": '+n.escapeExpression("function"==typeof(r=null!=(r=a(l,"photoWidth")||(null!=t?a(t,"photoWidth"):t))?r:n.hooks.helperMissing)?r.call(null!=t?t:n.nullContext||{},{name:"photoWidth",hash:{},data:o,loc:{start:{line:16,column:12},end:{line:16,column:26}}}):r)},7:function(n,t,l,e,o){var r,a=null!=t?t:n.nullContext||{},i=n.hooks.helperMissing,u="function",c=n.escapeExpression,p=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t"author": {\n\t\t\t"@type": "Person",\n\t\t\t"name": "'+c(typeof(r=null!=(r=p(l,"ownerName")||(null!=t?p(t,"ownerName"):t))?r:i)===u?r.call(a,{name:"ownerName",hash:{},data:o,loc:{start:{line:22,column:12},end:{line:22,column:25}}}):r)+'",\n\t\t\t"sameAs": "'+c(typeof(r=null!=(r=p(l,"ownerUrl")||(null!=t?p(t,"ownerUrl"):t))?r:i)===u?r.call(a,{name:"ownerUrl",hash:{},data:o,loc:{start:{line:23,column:14},end:{line:23,column:26}}}):r)+'"\n\t\t},\n'},9:function(n,t,l,e,o){var r,a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return',\n\t\t"description": "'+n.escapeExpression("function"==typeof(r=null!=(r=a(l,"description")||(null!=t?a(t,"description"):t))?r:n.hooks.helperMissing)?r.call(null!=t?t:n.nullContext||{},{name:"description",hash:{},data:o,loc:{start:{line:36,column:18},end:{line:36,column:33}}}):r)+'"'},compiler:[8,">= 4.3.0"],main:function(n,t,l,e,o){var r,a=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(r=a(l,"if").call(null!=t?t:n.nullContext||{},null!=t?a(t,"url"):t,{name:"if",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o,loc:{start:{line:1,column:0},end:{line:39,column:7}}}))?r:""},useData:!0}),e={};n.Array.each([],(function(t){var l=n.Template.get("hermes/"+t);l&&(e[t]=l)})),n.Template.register("hermes/head-article",(function(t,o){return(o=o||{}).partials=o.partials?n.merge(e,o.partials):e,l(t,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photostream-page-view",(function(e,t){require("hermes-core/flog")(t),new e.SubscriptionsHelper;var i="use_pref";e.namespace("Views")[this.name]=e.Base.create("photostream-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"global-nav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-photostream-coverphoto-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-subnav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["photostream"],dealbreaker:!0},"pagination-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,additionalViewClasses:["photostream"]},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},initializer:function(e){return this.nsid=e.nsid,this.isOwner=e.isOwner,this.withPhotoId=e.withPhotoId,this.contextSuffix=e.contextSuffix,this.pageParams=e.pageParams,this.isRouting=!1,this.isTwitterbot=e.isTwitterbot,this.isHelloPro=e.isHelloPro,e.isViewingSelf=!!this.appContext.getViewer().signedIn&&this.nsid===this.appContext.getViewer().nsid,e.photostreamId=e.nsid,e.modelRegistryName="photostream-models",e.photoListConfig={parentName:"photolist-container",pageParams:e.pageParams,measureAFT:!0,maintainScrollPosition:!1,scrollToWithId:e.withPhotoId,contextSuffix:e.contextSuffix,allowLazyLoading:!0},e.photoListConfig.modelParams={registryName:"photostream-models",modelIdOrAttributes:e.nsid+"-"+e.contextSuffix,collectionAttributeName:"photoPageList",fetchParams:{}},e.photoListConfig.modelParams.fetchParams.orderBy=i,e.photoListConfig.modelParams.fetchParams.viewAs=i,e.photoListConfig.layout={targetRowHeight:320,targetRowHeightTolerance:.1,awakeBoundsToViewportSizeRatio:5,containerPadding:{top:0,right:0,bottom:8,left:0},itemSpacing:{horizontal:4,vertical:4}},this.photoListConfig=e.photoListConfig,e.subnavConfig={selected:"photostream"},this.geo=e.geo,this},loadState:function(){var t=this,i={},o=[];return this.withPhotoId&&(i.withPhotoId=this.withPhotoId),o.push(this.appContext.getModel("photostream-models",this.nsid+"-"+this.contextSuffix,i).then((function(e){t.set("photostreamModel",e),YUI.Env.isServer||t.recalculateNominalPage(e)}))),e.Promise.all(o)},buildContainer:function(){return this.setContainerWithTemplate("photostream-page",{"fluid-header":this.subviews["fluid-photostream-coverphoto-view"]?this.subviews["fluid-photostream-coverphoto-view"].get("container"):"",isEmpty:!(this.isRouting||!this.get("photostreamModel"))&&0===parseInt(this.get("photostreamModel").getValue("totalItems"),10),isViewingSelf:this.nsid===this.appContext.getViewer().nsid}),this},activate:function(){this.get("container");return e.later(100,this,(function(){e.use("photo-page-scrappy-view")})),this.nsid!==this.appContext.getViewer().nsid&&this.appContext.getViewCounter().recordPhotostreamView({photostreamOwnerId:this.nsid,referrer:this.appContext.getReferrer()}),this.isHelloPro?this.appContext.getModel("person-models",this.nsid).then(function(e){this.showHelloProModal(e)}.bind(this)):this},onSubviewEvent:function(e,t){"photostream:filter"===t[0]&&this.appContext.flapp.navigate(window.location.href)},recalculateNominalPage:function(e){var t;1!==this.pageParams.page&&-1!==this.appContext.getLocation().href.search(/page[0-9]+/)&&(t=Math.ceil(e.getValue("totalItems")/this.pageParams.viewPageSize),this.pageParams.nominalPage>t&&(this.isRouting=!0,this.appContext.flapp.navigate(this.appContext.getLocation().pathname.replace(/page[0-9]+/,""))))},buildHeadContainer:function(){var t,i,o,a=this.get("photostreamModel"),s=a?a.getValue("photoPageList").getList():[];a&&(o=s.length?this.intlMessage({intlName:"meta.PHOTOSTREAM",username:a.getValue("owner").getValue("displayname"),photoCount:a.getValue("totalItems")}):this.intlMessage({intlName:"meta.PHOTOSTREAM_NO_PHOTOS",username:a.getValue("owner").getValue("displayname")})),t=s.length>0&&s[0]?s[0].getSizeToFit({width:640,height:480}):{},i=this.templates("dynamic-page-head")({title:a?a.getValue("owner").getValue("displayname"):null,description:o,url:a?a.getValue("url"):null,embedUrl:"/photostreams/"+this.nsid,fullURL:a?e.url(a.getValue("url")):null,openGraphImageURL:t.url?e.URLHelper.addProtocolToURL(t.url):null,openGraphImageWidth:t.width,openGraphImageHeight:t.height,ownerURL:a?e.url(a.getValue("owner").getValue("url")):null,ogType:"article",twitterCardType:"player",openId:!0,domain:e.url(),feeds:a?[{title:this.intlMessage({intlName:"meta.PHOTOSTREAM_ATOM_TITLE",username:a.getValue("owner").getValue("displayname")}),url:"/services/feeds/photos_public.gne?id="+a.getValue("normalizedId")+"&lang="+this.appContext.lang.toLowerCase()+"&format=atom"}]:[]}),i+=this.templates("head-article")({title:a?a.getValue("owner").getValue("displayname"):null,url:a?e.url(a.getValue("url")):null,ownerUrl:a?e.url(a.getValue("url")):null,ownerName:a?a.getValue("owner").getValue("displayname"):null,photoUrl:t.url?e.URLHelper.addProtocolToURL(t.url):null,photoHeight:t.height,photoWidth:t.width,description:o}),i+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, viewport-fit=cover, initial-scale=1, maximum-scale=1"}),i+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noarchive"}),i+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noarchive"}),YUI.Env.isServer?this.set("headContainer",i):(this.set("headContainer",i.concat(this.subviews["pagination-view"].get("headContainer"))),this.updateHead())},showHelloProModal:function(t){var i=e.URLHelper.generatePersonUrls(t),o=new e.Views.FluidModal({actionButtonLabel:this.intlMessage({intlName:"checkout.OK_THANKS"}),htmlMessage:this.templates("pro-hello-pro")({photostreamURL:e.url(i.photostream)}),showBodyLines:!0,showHeader:!1,appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!1,actionButtonDisabled:!1,actionButtonIsDangerous:!1,showCancelButton:!1,classList:"welcome-pro-modal",showCancelX:!1});o.on("activated",(function(t){setTimeout((function(){e.config.win.history.replaceState({},"",i.photostream)}),1e3)})),o.on("actionClick",(function(t){e.config.win.location=e.url(i.photostream)})),o.show()},setupLimitOverlay:function(){var t=this.get("container");this.limitOverlaySubview.show(),this.photoListSubview=this.subviews["photo-list-view"],t.addClass("with-photo-limit-overlay"),setTimeout((function(){e.config.win.scrollTo(0,0)}),200),this.registerEventHandler(e.on("photoLimitOverlay:hidden",(function(){t.removeClass("with-photo-limit-overlay")})))}})}),"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","hermes-template-photostream-page","global-nav-view","footer-full-view","photo-list-view","pagination-view","person-models","fluid-photostream-coverphoto-view","fluid-magic-subnav-view","fluid-modal-view","hermes-template-dynamic-page-head","hermes-template-head-meta","hermes-template-head-article","hermes-template-pro-hello-pro","url-helper","subscriptions-helper","storage-helper","url"],optionalRequires:["hermes-core"],optional:["photostream-models"],langBundles:["header","common","meta","checkout","magic-empty-states","filter-bar"]});YUI.add("notification-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,attributes:{id:{},isSeen:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},isMuted:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},type:{validator:function(e,r){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e)}},timestamp:{validator:function(e,r){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)}},activityData:{},eventDataList:[],userModels:[],activityEntityModels:{},eventEntityModelsList:[]}})}),"@VERSION@",{requires:["flickr-model-registry"]});YUI.add("contact-models",(function(e){"use strict";function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return e}},username:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},iconfarm:{},iconserver:{},buddyicon:{},nsid:{readOnly:!0,defaultFn:function(e){return e}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}},isPro:{defaultValue:!1,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},proBadge:{defaultValue:"standard",setter:function(t){return e.AttributeHelpers.coerceString(t)}},profileURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/photos/"+t}},followsURL:{readOnly:!0,derivedBy:["pathAlias","nsid"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return t||(t=e),"/people/"+t+"/contacts"}}}})}),"@VERSION@",{requires:["flickr-model-registry","attribute-helpers","url-helper"]});YUI.add("flickr-notifications-markread-updater",(function(r,i){"use strict";r.namespace("ModelUpdaters")["flickr-notifications-markread"]={run:function(e,a){return a.callAPI("flickr.notifications.markread",e).then(null,r.FetcherErrorLogger(i))}}}),"@VERSION@",{requires:["flickr-promise"]});YUI.add("flickr-activity-getNotificationsCount-fetcher",(function(t,i){"use strict";t.namespace("ModelFetchers")["flickr-activity-getNotificationsCount"]={run:function(e,o){var n=this,s=this._processParams(e);return t.FlickrPromise({apiResponse:o.callAPI("flickr.activity.getNotificationsCount",s),personNotifsModelRegistry:o.getModelRegistry("person-notifications-models")}).then((function(t){return n._processResponse(t,o,s)}),t.FetcherErrorLogger(i))},_processParams:function(i){var e=i.notification_groups||"default,hermes_2020,groups_you_admin,bot_moderation";return t.merge(i,{notification_groups:e})},_processResponse:function(t,i,e){var o=t.apiResponse,n=t.personNotifsModelRegistry,s=n.getValue(e.id,"unseenNotificationCounts")||{};return n.setValue(e.id,"unseenNotificationCount",o.activity.count),n.setValue(e.id,"unseenNotificationCounts",Object.assign(s,o.activity)),o.activity.count}}}),"@VERSION@",{requires:["flickr-promise"],optional:["person-notifications-models","api-helper"]});